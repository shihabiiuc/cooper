---
import { siteConfig, NAV_LINKS, ACTION_LINKS, FOOTER_LINKS } from '~/site.config';
import { Github, Facebook, Linkedin, Youtube } from 'lucide-react';
import { ui, defaultLang } from '~/i18n/ui';
import { useTranslations } from '~/i18n/utils';

const today = new Date();
const { lang = defaultLang } = Astro.params;
const t = useTranslations(lang);
---

<footer class="mt-auto border-t border-foreground/10 bg-background py-12">
  <div class="max-w-7xl mx-auto px-6">
    <div class="grid grid-cols-1 md:grid-cols-4 gap-8 mb-12">
      <div class="col-span-1 md:col-span-2 flex flex-col items-start gap-4">
        <div class="flex flex-col gap-2">
          <span class="text-xl font-bold font-display tracking-tight">{siteConfig.name}</span>
          <p class="text-sm text-muted-foreground/80 max-w-xs">
            {t['footer.quote']}
          </p>
        </div>

        <div class="mt-4 w-full">
          <h3 class="text-sm font-semibold text-foreground mb-2">{t['footer.newsletter.title']}</h3>
          <form class="flex gap-2 max-w-sm w-full">
            <label for="newsletter-email" class="sr-only">Email address</label>
            <input 
              id="newsletter-email"
              type="email" 
              placeholder={t['footer.newsletter.placeholder']}
              class="bg-background border border-foreground/10 rounded-full px-4 py-2 text-sm w-full focus:outline-none focus:ring-2 focus:ring-primary/50 placeholder:text-muted-foreground/70 text-foreground"
            />
            <button type="submit" class="bg-foreground text-background rounded-full px-4 py-2 text-sm font-medium hover:opacity-90 transition-opacity whitespace-nowrap">
              {t['footer.newsletter.button']}
            </button>
          </form>
        </div>
      </div>
      
      {Object.entries(FOOTER_LINKS).map(([key, section]) => (
        <div>
          <h3 class="font-semibold mb-4 text-foreground">{t[`footer.${key}` as keyof typeof t] || section.title}</h3>
          <ul class="space-y-2 text-sm text-foreground/90">
            {section.links.map((link: any) => {
              
              const shouldLocalize = link.localize !== false;
              const href = (!shouldLocalize)
                ? link.href 
                : `/${lang}${link.href.startsWith('/') ? '' : '/'}${link.href}`.replace(/\/$/, '') || `/${lang}`;
              
              return (
                <li>
                  <a 
                    href={href} 
                    class="hover:text-foreground transition-colors"
                    aria-label={t[`footer.${link.label.toLowerCase()}` as keyof typeof t] || link.label}
                  >
                    {t[`footer.${link.label.toLowerCase()}` as keyof typeof t] || link.label}
                  </a>
                </li>
              );
            })}
          </ul>
        </div>
      ))}
    </div>

    <div class="pt-8 border-t border-foreground/10 flex flex-col md:flex-row justify-between items-center gap-4">
      <div class="text-muted-foreground text-sm">
        {(t['footer.copyright'] || '').replace('{year}', today.getFullYear().toString())}
      </div>
      
      <div class="flex gap-4">
        <a href={ACTION_LINKS.social.linkedin} target="_blank" rel="noopener noreferrer" class="text-muted-foreground hover:text-foreground transition-colors" aria-label="LinkedIn">
          <Linkedin className="w-5 h-5" strokeWidth={1.5} />
        </a>
        <a href={ACTION_LINKS.social.youtube} target="_blank" rel="noopener noreferrer" class="text-muted-foreground hover:text-foreground transition-colors" aria-label="YouTube">
          <Youtube className="w-5 h-5" strokeWidth={1.5} />
        </a>
        <a href={ACTION_LINKS.social.github} target="_blank" rel="noopener noreferrer" class="text-muted-foreground hover:text-foreground transition-colors" aria-label="GitHub">
          <Github className="w-5 h-5" strokeWidth={1.5} />
        </a>
        <a href={ACTION_LINKS.social.facebook} target="_blank" rel="noopener noreferrer" class="text-muted-foreground hover:text-foreground transition-colors" aria-label="Facebook">
          <Facebook className="w-5 h-5" strokeWidth={1.5} />
        </a>
      </div>
    </div>
  </div>
</footer>
